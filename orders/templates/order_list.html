{% extends "base.html" %}
{% block content %}
    <h2>–ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–∫–∞–∑—ã</h2>
    <form method="get" class="search-form">
        <input type="text" name="search" value="{{ search_query }}"
               placeholder="–ü–æ–∏—Å–∫ –ø–æ ID, —Å—Ç–æ–ª–∏–∫—É –∏–ª–∏ –±–ª—é–¥–∞–º...">
        <button type="submit">üîç</button>
    </form>

    <div class="order-list">
        {% for order in orders %}
        <div class="order-card">
            <div class="order-header">
                <strong>–ó–∞–∫–∞–∑ #{{ order.id }}</strong>
                <span class="status-indicator status-{{ order.status }}">
                    {% if order.status == '–í –æ–∂–∏–¥–∞–Ω–∏–∏' %}
                        ‚è≥
                    {% elif order.status == '–ì–æ—Ç–æ–≤–æ' %}
                        ‚úÖ
                    {% else %}
                        üíµ
                    {% endif %}
                    {{ order.status }}
                </span>
            </div>

            <p>–°—Ç–æ–ª–∏–∫: <strong>{{ order.table_number }}</strong></p>

            <div class="dish-list">
                {% for item in order.items %}
                <div class="dish-item">
                    {{ item.name }} - {{ item.price|floatformat:2 }} —Ä—É–±.
                </div>
                {% endfor %}
            </div>

            <div class="order-footer">
                <p>–°—É–º–º–∞: <strong>{{ order.total_price|floatformat:2 }} —Ä—É–±.</strong></p>

                <div class="actions">
                    <form method="post" action="{% url 'update_status' order.id %}" class="status-form">
                        {% csrf_token %}
                        <select name="status" onchange="this.form.submit()">
                            <option value="–í –æ–∂–∏–¥–∞–Ω–∏–∏" {% if order.status == '–í –æ–∂–∏–¥–∞–Ω–∏–∏' %}selected{% endif %}>
                                –í –æ–∂–∏–¥–∞–Ω–∏–∏
                            </option>
                            <option value="–ì–æ—Ç–æ–≤–æ" {% if order.status == '–ì–æ—Ç–æ–≤–æ' %}selected{% endif %}>
                                –ì–æ—Ç–æ–≤–æ
                            </option>
                            <option value="–û–ø–ª–∞—á–µ–Ω–æ" {% if order.status == '–û–ø–ª–∞—á–µ–Ω–æ' %}selected{% endif %}>
                                –û–ø–ª–∞—á–µ–Ω–æ
                            </option>
                        </select>
                    </form>

                    <form method="post" action="{% url 'order_delete' order.id %}"
                          onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å –∑–∞–∫–∞–∑ #{{ order.id }}?')">
                        {% csrf_token %}
                        <button type="submit" class="delete-btn">üóëÔ∏è</button>
                    </form>
                </div>
            </div>
        </div>
        {% empty %}
        <p>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤</p>
        {% endfor %}
    </div>
{% endblock %}